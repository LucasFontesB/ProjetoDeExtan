package application;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.time.LocalDateTime;
import java.util.ArrayList;
import java.util.List;

import javafx.application.Application;
import javafx.fxml.FXMLLoader;
import javafx.scene.Parent;
import javafx.scene.Scene;
import javafx.stage.Stage;

public class App extends Application{

    public static void main(String[] args) {
       List<Integer> ids_com_turnos_abertos = new ArrayList<>();
       LocalDateTime data_hora_atual = LocalDateTime.now();
       System.out.println("Iniciando Verificação De Turnos Abertos...\n");
	   String sql_verificar_ids_turnos_abertos = "SELECT id_usuario FROM registros_turnos WHERE horario_final IS NULL";
       PreparedStatement ps_verificar_ids_turnos_abertos = null;
       Connection conn_verificar_ids_turnos_abertos = null;
       
       try {
     	   conn_verificar_ids_turnos_abertos = Conectar_Banco_Dados.getConnection();
           System.out.println("\nConexão estabelecida com sucesso para Verificar Turnos Abertos: " + (conn_verificar_ids_turnos_abertos != null));
           ps_verificar_ids_turnos_abertos = conn_verificar_ids_turnos_abertos.prepareStatement(sql_verificar_ids_turnos_abertos);
           ResultSet id_usuario_achado_turnos_abertos = ps_verificar_ids_turnos_abertos.executeQuery();
           
           
           while(id_usuario_achado_turnos_abertos.next()) {
         	  int id_usuario = id_usuario_achado_turnos_abertos.getInt(1);
         	  ids_com_turnos_abertos.add(id_usuario);
         	  System.out.println("Id De Usuario Com Turno Aberto: " + id_usuario);
           }
           
           for(int id_turno : turnos_abertos) {
        	   
           }
           
           System.out.println("\nFIM DO LOG DE VERIFICAÇÃO DE TURNOS ABERTOS\n");
       }catch (Exception erro_ao_definir_usuario_logado) {
     	  erro_ao_definir_usuario_logado.printStackTrace();
       }
       
        launch(args);
    }

    @Override
    public void start(Stage primaryStage) throws Exception {
        FXMLLoader fxmlLoader = new FXMLLoader(getClass().getResource("/views/tela_login.fxml"));
        Parent root = fxmlLoader.load();
        Scene tela = new Scene(root);
        
        primaryStage.setTitle("Gerenciador De Passeios");
        primaryStage.setScene(tela);
        primaryStage.show();
    }
}
